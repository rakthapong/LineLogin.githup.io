<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>LINE Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-store">
</head>

<body style="font-family:sans-serif;text-align:center;margin-top:100px;">

<div id="loading">
  <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏≤‡πÑ‡∏õ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏î‡πâ‡∏ß‡∏¢ LINE‚Ä¶</p>
</div>

<div id="success" style="display:none;">
  <h2>‚úÖ ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏î‡πâ‡∏ß‡∏¢ LINE ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</h2>
  <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏û‚Ä¶</p>

  <p>
    üëâ <a
      href="https://www.appsheet.com/start/1e844dd1-1d99-431f-909c-eb52684f5ccf#view=user_home"
      target="_blank"
      style="font-size:18px;color:#06c;"
    >
      ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏û AppSheet
    </a>
  </p>
</div>

<script>
  const params = new URLSearchParams(window.location.search);

  const LINE_CHANNEL_ID = "2008686694";

  // üî¥ URL doGet ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô)
  const GAS_URL =
    "https://script.google.com/macros/s/AKfycbwuSKp7QwvLI0Ubwn9eIiHzOE-K_HJaIWme_lu_q2c1e_HaSZKbBsBTYAVAIpsf37DZQQ/exec";

  // ‚úÖ ‡∏ñ‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß
  if (params.get("success") === "1") {
    document.getElementById("loading").style.display = "none";
    document.getElementById("success").style.display = "block";
  }
  // üîÅ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô ‚Üí ‡∏û‡∏≤‡πÑ‡∏õ LINE Login
  else {
    const authUrl =
      "https://access.line.me/oauth2/v2.1/authorize" +
      "?response_type=code" +
      "&client_id=" + LINE_CHANNEL_ID +
      "&redirect_uri=" + encodeURIComponent(GAS_URL) +
      "&scope=profile" +
      "&state=login";

    window.location.replace(authUrl);
  }
</script>

</body>
</html>
