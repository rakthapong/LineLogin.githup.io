<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>LINE Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body style="font-family:sans-serif;text-align:center;padding-top:80px;">

<script>
  /******** CONFIG ********/
  const LINE_CHANNEL_ID = "2008686694";

  const GAS_URL =
    "https://script.google.com/macros/s/AKfycbwuSKp7QwvLI0Ubwn9eIiHzOE-K_HJaIWme_lu_q2c1e_HaSZKbBsBTYAVAIpsf37DZQQ/exec";

  const APPSHEET_USER_URL =
    "https://www.appsheet.com/start/1e844dd1-1d99-431f-909c-eb52684f5ccf#view=user_home";
  /************************/

  const params = new URLSearchParams(window.location.search);

  // ===== ‡∏ñ‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß =====
  if (params.get("success") === "1") {
    document.write(`
      <h2>‚úÖ ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏î‡πâ‡∏ß‡∏¢ LINE ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</h2>
      <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏û‚Ä¶</p>
      <p>
        üëâ <a href="${APPSHEET_USER_URL}" target="_blank">
          ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏û AppSheet
        </a>
      </p>
    `);

    // ‡πÄ‡∏õ‡∏¥‡∏î AppSheet ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÑ‡∏ß‡πâ)
    setTimeout(() => {
      window.open("${APPSHEET_USER_URL}", "_blank");
    }, 1500);

  } else {
    // ===== ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô ‚Üí ‡πÄ‡∏î‡πâ‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ LINE ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ =====
    const authUrl =
      "https://access.line.me/oauth2/v2.1/authorize" +
      "?response_type=code" +
      "&client_id=" + LINE_CHANNEL_ID +
      "&redirect_uri=" + encodeURIComponent(GAS_URL) +
      "&state=login" +
      "&scope=profile";

    window.location.replace(authUrl);
  }
</script>

</body>
</html>
