<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <title>Login with LINE</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>

<h3>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢ LINE...</h3>

<script>
const LIFF_ID = "2008686694-bLB6mwvm";
const GAS_API_URL =
  "https://script.google.com/macros/s/AKfycbzHGYYhlpbCuSETjI7EJGflUi3Cmv51lYs7V-sMSJRayLI_o7osbb5NpTV8Zp9Dgp9d/exec";

const APPSHEET_URL =
  "https://www.appsheet.com/start/9e2e7172-8357-4bf4-82b8-da1d886b79d7";

(async () => {
  await liff.init({ liffId: LIFF_ID });

  if (!liff.isLoggedIn()) {
    liff.login();
    return;
  }

  const profile = await liff.getProfile();
  const uid = profile.userId;

  // ‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏µ‡πà GAS
  const img = new Image();
  img.src = GAS_API_URL + "?lineUserId=" + uid + "&t=" + Date.now();

  // üî• login AppSheet ‡∏î‡πâ‡∏ß‡∏¢ username/password ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
  setTimeout(() => {
    window.location.href =
      APPSHEET_URL +
      "?username=" + encodeURIComponent(uid) +
      "&password=auto";
  }, 800);
})();
</script>

</body>
</html>
