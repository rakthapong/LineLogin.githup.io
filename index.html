<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>LINE Login</title>
</head>
<body>

<script>
  const channelId = "2008686694";
  const redirectUri =
    "https://script.google.com/macros/s/AKfycbxR8b3LtZ_PX_53Dl1mQgfux_HofRukoaYL4AStRGuumszwSqSBzfWlACGFdMRacSzu/exec";

  // üîπ ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ code ‚Üí ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß
  if (location.search.includes("code=")) {

    alert("‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢ LINE ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß ‚úÖ");

    document.body.innerHTML = `
      <h3>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</h3>
      <p>‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏≠‡∏õ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</p>
      <button onclick="openApp()">‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏õ</button>
    `;

  } else {
    // üîπ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô ‚Üí ‡∏û‡∏≤‡πÑ‡∏õ LINE
    const authUrl =
      "https://access.line.me/oauth2/v2.1/authorize" +
      "?response_type=code" +
      "&client_id=" + channelId +
      "&redirect_uri=" + encodeURIComponent(redirectUri) +
      "&state=login" +
      "&scope=profile";

    location.href = authUrl;
  }

  function openApp() {
    window.location.href = "https://www.appsheet.com/start";
  }
</script>

</body>
</html>
