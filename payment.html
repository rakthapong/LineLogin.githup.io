<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-store" />
</head>

<body style="font-family:sans-serif;text-align:center;padding-top:80px;">

<script>
/******** CONFIG ********/
const LINE_CHANNEL_ID = "2008686694";
const GAS_URL =
  "https://script.google.com/macros/s/AKfycbxkWL4o2WNbLB_NFIVqS6lNvcL3ef3YMUthVTPoGsdUGNmhOKG7CEj-9xwH3VZ1aMXATA/exec";

// üëâ View ‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
const PAYMENT_VIEW_URL =
  "https://www.appsheet.com/newshortcut/1e844dd1-1d99-431f-909c-eb52684f5ccf?view=payment_user";
/************************/

const params = new URLSearchParams(window.location.search);

// üîê ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢ login ‚Üí ‡∏û‡∏≤‡πÑ‡∏õ LINE Login
function goLogin() {
  const authUrl =
    "https://access.line.me/oauth2/v2.1/authorize" +
    "?response_type=code" +
    "&client_id=" + LINE_CHANNEL_ID +
    "&redirect_uri=" + encodeURIComponent(GAS_URL) +
    "&state=login" +
    "&scope=profile";

  location.href = authUrl;
}

// üöÄ login ‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡πÄ‡∏Ç‡πâ‡∏≤ AppSheet ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
function openPayment() {
  location.href = PAYMENT_VIEW_URL;
  setTimeout(() => window.open(PAYMENT_VIEW_URL, "_blank"), 800);
}

// ===== LOGIC ‡∏Å‡∏•‡∏≤‡∏á =====
if (params.get("success") === "1") {
  // ‡πÄ‡∏Ñ‡∏¢ login ‡πÅ‡∏•‡πâ‡∏ß
  openPayment();
} else {
  // ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà login
  goLogin();
}
</script>

<p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏≤‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‚Ä¶</p>

</body>
</html>
